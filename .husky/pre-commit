#!/bin/sh

echo "ğŸ” Running pre-commit checks..."

# â”€â”€ Server type check â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
echo "ğŸ“¦ Server â€” Type check..."
cd server && npm run typecheck
if [ $? -ne 0 ]; then
  echo "âŒ Server type check failed. Aborting commit."
  exit 1
fi
cd ..

# â”€â”€ UI type check â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
echo "ğŸ“¦ UI â€” Type check..."
cd ui && npm run typecheck
if [ $? -ne 0 ]; then
  echo "âŒ UI type check failed. Aborting commit."
  exit 1
fi
cd ..

# â”€â”€ SaaS Website type check + lint â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
echo "ğŸ“¦ SaaS Website â€” Type check..."
cd saas-website && npm run typecheck
if [ $? -ne 0 ]; then
  echo "âŒ SaaS Website type check failed. Aborting commit."
  exit 1
fi

echo "ğŸ“¦ SaaS Website â€” Lint check..."
npm run lint
if [ $? -ne 0 ]; then
  echo "âŒ SaaS Website lint check failed. Run 'npm run format' to fix."
  exit 1
fi
cd ..

# â”€â”€ Server build check â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
echo "ğŸ“¦ Server â€” Build check..."
cd server && npm run build
if [ $? -ne 0 ]; then
  echo "âŒ Server build failed. Aborting commit."
  exit 1
fi
cd ..

# â”€â”€ UI build check â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
echo "ğŸ“¦ UI â€” Build check..."
cd ui && npm run build
if [ $? -ne 0 ]; then
  echo "âŒ UI build failed. Aborting commit."
  exit 1
fi
cd ..

# â”€â”€ SaaS Website build check â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
echo "ğŸ“¦ SaaS Website â€” Build check..."
cd saas-website && npm run build
if [ $? -ne 0 ]; then
  echo "âŒ SaaS Website build failed. Aborting commit."
  exit 1
fi
cd ..

# â”€â”€ Ecomm Demo type check â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
echo "ğŸ“¦ Ecomm Demo â€” Type check..."
cd ecomm-client-demo && npm run typecheck
if [ $? -ne 0 ]; then
  echo "âŒ Ecomm Demo type check failed. Aborting commit."
  exit 1
fi
cd ..

# â”€â”€ Ecomm Demo build check â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
echo "ğŸ“¦ Ecomm Demo â€” Build check..."
cd ecomm-client-demo && npm run build
if [ $? -ne 0 ]; then
  echo "âŒ Ecomm Demo build failed. Aborting commit."
  exit 1
fi
cd ..

echo "âœ… All checks passed! Committing..."
